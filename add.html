<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Create Challenge — Clean Tracker</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-72.svg" type="image/svg+xml">
  <meta name="theme-color" content="#071227">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600,800&display=swap" rel="stylesheet">
  <style>
    body{margin:0;background:linear-gradient(180deg,#020617,#071227);color:#e6eef8;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
    .wrap{max-width:820px;margin:28px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between}
    h1{margin:0}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);margin-top:18px}
    label{display:block;margin-top:8px;color:#9aa7bd}
    input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;margin-top:6px}
    .controls{display:flex;gap:8px;margin-top:12px}
    .btn{background:linear-gradient(90deg,#60a5fa,#7dd3fc);border:0;padding:8px 12px;border-radius:10px;color:#03212a;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#9aa7bd}
    a{color:inherit;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Create Challenge</h1>
      <div><a href="home.html"><button class="btn ghost">← Back</button></a></div>
    </header>

    <div class="card">
      <label>Challenge name</label>
      <input id="name" placeholder="e.g. 30-Day Clean Challenge">

      <label>Duration (days)</label>
      <input id="days" type="number" min="1" max="365" value="30">

      <label>Start date</label>
      <input id="start" type="date" value="">
      <label>Description (optional)</label>
      <textarea id="desc" rows="4" placeholder="Why are you doing this challenge?"></textarea>

      <div class="controls">
        <button id="createBtn" class="btn">Create</button>
        <a href="home.html"><button class="btn ghost" type="button">Cancel</button></a>
      </div>
    </div>
  </div>

<script>
const KEY = 'ct_challenges_v1';
function load(){ try{return JSON.parse(localStorage.getItem(KEY))||{challenges:{}}}catch(e){return {challenges:{}}} }
function save(s){ localStorage.setItem(KEY, JSON.stringify(s)); }
function uid(){ return 'c_' + Date.now().toString(36) + Math.random().toString(36).slice(2,7); }

document.getElementById('start').value = new Date().toISOString().slice(0,10);

document.getElementById('createBtn').addEventListener('click', ()=>{
  const name = document.getElementById('name').value.trim();
  const days = parseInt(document.getElementById('days').value, 10);
  const start = document.getElementById('start').value;
  const desc = document.getElementById('desc').value.trim();
  if(!name){ alert('Enter a challenge name'); return; }
  if(isNaN(days) || days < 1){ alert('Enter a valid duration'); return; }
  if(!start){ alert('Choose a start date'); return; }
  const s = load();
  const id = uid();
  s.challenges[id] = { id, name, days, startDate: start, description: desc, entries: {} };
  save(s);
  // go to challenge page immediately
  location.href = `challenge.html?id=${encodeURIComponent(id)}`;
});
</script>
</body>
</html>

